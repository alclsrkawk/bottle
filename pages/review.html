<link rel="stylesheet" href="../css/review.min.css">
<script defer src="../js/review.js"></script>

<section class="main-section">
    <div class="popbg"></div>
    <article>
        <div id="review-menu-tab">
            <p class="menu-tab-01"><a href="#goods_ex_line">상세정보</a></p>
            <p class="menu-tab-02"><a href="#review-menu-tab">상품후기</a></p>
        </div>
    </article>

    <article>
        <div class="review-count">
            <div class="star-count">
                <span class="star count">★</span>
                <span class="star count">★</span>
                <span class="star count">★</span>
                <span class="star count">★</span>
                <span class="star">★</span>
            </div>
            <span class="review-score">4.0</span>
        </div>
        <div class="review-container">
            <div class="tab">
                <p>총 <span>4</span>건</p>
                <div class="review-tab-right">
                    <div class="selectBox">
                        <button class="label">최신순</button>
                        <ul class="optionList">
                            <li class="optionItem">최신순</li>
                            <li class="optionItem">인기순</li>
                            <li class="optionItem">별점순</li>
                        </ul>
                    </div>
                    <p class="write-btn">후기 작성하기</p>
                </div>
            </div>
            <!-- 후기 작성하기 버튼 클릭 -> 팝업 -->
            <div class="write-review">
                <div class="popup-container">
                    <form id="review-popup">
                        <div class="tab">
                            <p>후기 작성</p>
                            <span class="close"></span>
                        </div>
                        <div class="goods">
                            <p class="goods_img"></p>
                            <div class="goods_info">
                                <div>
                                    <span>금용농산</span>
                                    <p>미르아토 레드스위트와인 750ml</p>
                                </div>
                                <div class="star-container">
                                    <div class="star">
                                        ★★★★★
                                        <span>★★★★★</span>
                                        <input type="range" oninput="drawStar(this)" value="1" step="1" min="0"
                                            max="10">
                                    </div>
                                    <span class="star-grade">0.0</span>
                                </div>
                            </div>
                        </div>
                        <textarea placeholder="후기를 작성해주세요.(10자 이상)"></textarea>
                        <button class="next-btn">등록하기</button>
                    </form>
                    <div class="next-step">
                        <div>
                            <div class="icon"></div>
                            <strong>등록 완료</strong>
                            <p>고객님의 소중한 후기<br>감사드립니다.</p>
                        </div>
                        <p class="close">닫기</p>
                    </div>
                </div>
            </div>

            <div class="review-list-container">
                <div class="list-result 1">
                    <div class="left">
                        <div class="star-count">
                            <span class="star count">★</span>
                            <span class="star count">★</span>
                            <span class="star count">★</span>
                            <span class="star count">★</span>
                            <span class="star">★</span>
                        </div>
                        <p class="user-id">idid****</p>
                        <p class="user-date">2023.12.21</p>
                    </div>
                    <div class="right">
                        <p>맛있습니다! 달달하고 좋은 사과향이 살아있고요, 엄청 목넘김도 부드러워 25도이지만 체감상 참이슬 소주보다 저도수처럼 느껴집니다 정말 잘만든 술이라 생각합니다.
                        </p>
                    </div>
                </div>
                <div class="list-result 2">
                    <div class="left">
                        <div class="star-count">
                            <span class="star count">★</span>
                            <span class="star count">★</span>
                            <span class="star count">★</span>
                            <span class="star count">★</span>
                            <span class="star">★</span>
                        </div>
                        <p class="user-id">sdfg****</p>
                        <p class="user-date">2023.12.20</p>
                    </div>
                    <div class="right">
                        <p>이번에 여러가지 주문했는데 역시 박재서 안동소주 22가 최고네요!
                            <br>식당에서 참이슬 5천원 주고 먹을바에는 술마켓에서 안동소주 구입해서 집에서 먹는게 100배 좋습니다
                            <br>좋은술 잘 샀습니다 감사합니다~
                        </p>
                    </div>
                </div>
                <div class="list-result 3">
                    <div class="left">
                        <div class="star-count">
                            <span class="star count">★</span>
                            <span class="star count">★</span>
                            <span class="star count">★</span>
                            <span class="star count">★</span>
                            <span class="star">★</span>
                        </div>
                        <p class="user-id">35****</p>
                        <p class="user-date">2023.12.19</p>
                    </div>
                    <div class="right">
                        <p>편의점에서 발견해서 크림빵이랑 같이 한잔 했습니다. 와…..
                            <br>대기업은 대기업입니다.
                            <br>뭔가 칵테일바에서 비싸게 주문한 스페셜한 칵테일같았어요.
                            <br>외관껍질을 분리한 후 친구들과 전통주 첫 시식 파티할때 드시면 좋을거 같습니다.
                            <br>메리 술리스마스!
                        </p>
                    </div>
                </div>
                <div class="list-result 4">
                    <div class="left">
                        <div class="star-count">
                            <span class="star count">★</span>
                            <span class="star count">★</span>
                            <span class="star count">★</span>
                            <span class="star count">★</span>
                            <span class="star">★</span>
                        </div>
                        <p class="user-id">sky****</p>
                        <p class="user-date">2023.12.18</p>
                    </div>
                    <div class="right">
                        <p>맛있습니다! 달달하고 좋은 사과향이 살아있고요, 엄청 목넘김도 부드러워 25도이지만 체감상 참이슬 소주보다 저도수처럼 느껴집니다 정말 잘만든 술이라 생각합니다.
                        </p>
                    </div>
                </div>
            </div>
        </div>


    </article>
</section>

<script>
    const selectBox = document.querySelector('.review-tab-right .selectBox'),
        label = document.querySelector('.selectBox .label'),
        optionList = document.querySelector('.selectBox .optionList'),
        optionItem = document.querySelectorAll('.selectBox .optionItem');

    // 드롭다운 메뉴 시작
    label.addEventListener('click', function () {
        optionList.classList.toggle('active');
        selectBox.classList.toggle('active');
    })

    optionItem.forEach(function (el) {
        el.addEventListener('mouseover', function () {
            el.classList.add('hover');
        })

        el.addEventListener('mouseout', function () {
            el.classList.remove('hover');
        })

        el.onclick = function () {
            optionItem.forEach(function (el) {
                el.classList.add('hover2')
            })
            el.removeEventListener('mouseover', function () {
                el.classList.add('hover');
            })
            let innerText = el.innerText;
            label.innerText = innerText;
            optionList.classList.toggle('active');
            selectBox.classList.toggle('active');
            let setTime = function () {
                optionItem.forEach(function (el) { el.classList.remove('hover2') })
            }
            setTimeout(setTime, 1000);
        }
    }) // 드롭다운 메뉴 끝

    // 후기작성 팝업 시작
    const writeBtn = document.querySelector('.review-tab-right .write-btn'),
        popCont = document.querySelector('.popup-container'),
        reviewPop = document.querySelector('#review-popup'),
        reviewPopBtn = document.querySelector('#review-popup .next-btn'),
        reviewPopText = document.querySelector('#review-popup textarea'),
        reviewNext = document.querySelector('.next-step'),
        reviewNextBtn = document.querySelector('.next-step .close'),
        closeBtn = document.querySelector('.close'),
        popBg = document.querySelector('.main-section .popbg');

    writeBtn.addEventListener('click', function (e) {
        e.preventDefault();
        reviewPop.classList.remove('hidden');
        popCont.classList.add('active');
        popBg.classList.add('bg-active');

        closeBtn.onclick = function () {
            popCont.classList.remove('active');
            popBg.classList.remove('bg-active');
        }

        reviewPopBtn.onclick = function (e) {
            e.preventDefault();

            let userReview = reviewPopText.value;
            console.log(userReview)

            reviewPop.classList.add('hidden');
            reviewNext.classList.add('active');
        }

        reviewNextBtn.onclick = function (e) {
            e.preventDefault();
            popCont.classList.remove('active');
            reviewNext.classList.remove('active');
            popBg.classList.remove('bg-active');
        }
    }) // 후기작성 팝업 끝
    // 후기작성 별점 시작
    const drawStar = (target) => {
        document.querySelector(`.star span`).style.width = `${target.value * 10}%`;
        let grade = target.value / 2;
        console.log('grade = ' + grade)

        if (Number.isInteger(grade)) {//정수이면
            console.log('grade는 정수니까 .0을 붙여야해용')
            grade = grade.toString() + '.0';
        }

        const starGrade = document.querySelector('.star-container .star-grade');
        starGrade.innerText = grade;

    }
    const dsf = [];
    //후기작성 별점 끝
</script>